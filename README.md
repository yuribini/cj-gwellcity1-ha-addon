# 청주 Gwellcity1 홈 어시스턴트 애드온

이 프로젝트는 청주 Gwellcity1차 아파트를 위한 홈 어시스턴트 애드온입니다. 아파트의 시스템 및 서비스와 통합을 제공합니다.

## 기능

- 청주 Gwellcity1차 cvnet Wallpad 시스템과 실시간 연동
- 전열교환기 On/Off 제어

## 설치 방법

1. 홈 어시스턴트의 Supervisor 패널로 이동합니다.
2. "애드온 스토어" 탭을 클릭합니다.
3. 우측 상단의 메뉴(세 개의 점)를 클릭하고 "저장소"를 선택합니다.
4. 다음 저장소 URL을 추가합니다: `https://github.com/yuribini/cj-gwellcity1-ha-addon`
5. "추가" 버튼을 클릭합니다.
6. 애드온 스토어에서 "CJ Gwellcity1 애드온"을 찾아 클릭합니다.
7. "설치" 버튼을 클릭합니다.

## 설정 가이드

애드온 설정 시 다음 항목들을 정확히 입력해야 합니다:

1. mqtt_host:
   - 설명: MQTT 브로커의 호스트 주소
   - 예시: "core-mosquitto" (Home Assistant 내장 MQTT 브로커 사용 시)
   - 주의: 외부 MQTT 브로커 사용 시 해당 브로커의 IP 주소나 도메인 이름 입력

2. mqtt_port:
   - 설명: MQTT 브로커의 포트 번호
   - 예시: 1883 (기본 포트)

3. mqtt_username:
   - 설명: MQTT 브로커 접속용 사용자 이름
   - 예시: "mqtt"

4. mqtt_password:
   - 설명: MQTT 브로커 접속용 비밀번호
   - 주의: 강력한 비밀번호 사용 권장

5. gwellcity1_host:
   - 설명: EW11 게이트웨이의 IP 주소
   - 예시: "192.168.1.100"
   - 주의: EW11 장치의 실제 IP 주소를 입력해야 합니다. 이 주소는 여러분의 네트워크 설정에 따라 다를 수 있습니다.

6. gwellcity1_port:
   - 설명: EW11 게이트웨이와 통신하기 위한 포트 번호
   - 예시: 8899
   - 주의: EW11 장치의 실제 포트 번호를 확인 후 입력해야 합니다. 기본값은 8899일 수 있지만, 실제 설정을 확인하세요.

EW11 게이트웨이의 IP 주소와 포트 번호를 찾는 방법:
1. 네트워크 라우터의 관리 인터페이스에 접속하여 연결된 장치 목록을 확인합니다.
2. EW11 또는 유사한 이름의 장치를 찾아 IP 주소를 확인합니다.
3. 포트 번호는 일반적으로 8899이지만, EW11 설정 문서나 관리자 인터페이스를 통해 확인할 수 있습니다.

각 설정 항목을 정확히 입력해야 애드온이 올바르게 작동합니다.

## 사용 방법

1. 애드온 설치 및 설정 완료 후, "시작" 버튼을 클릭하여 애드온을 실행합니다.
2. 애드온이 성공적으로 시작되면, CJ Gwellcity1 시스템의 데이터가 자동으로 홈 어시스턴트로 전송됩니다.
3. 홈 어시스턴트의 통합 구성요소에서 새로운 장치와 센서를 확인할 수 있습니다.
4. 대시보드에 위젯을 추가하여 CJ Gwellcity1 시스템의 상태를 모니터링하고 제어할 수 있습니다.
5. 전열교환기 제어:
   - On: MQTT 토픽 "homeassistant/gwellcity1/command"에 메시지 {"device": "heat_exchanger", "state": "on"} 발행
   - Off: MQTT 토픽 "homeassistant/gwellcity1/command"에 메시지 {"device": "heat_exchanger", "state": "off"} 발행

참고: 특정 기능이나 명령어는 아파트 시스템의 구현에 따라 다를 수 있습니다. 자세한 사용 방법은 아파트 관리사무소나 시스템 제공업체에 문의해 주세요.

## 문제 해결

애드온 실행 중 문제가 발생하면 다음 단계를 따라 문제를 해결해 보세요:

1. 애드온의 로그를 확인하여 오류 메시지를 확인합니다.
2. 설정값이 올바른지 다시 한 번 확인합니다.
3. 홈 어시스턴트와 CJ Gwellcity1 시스템이 같은 네트워크에 있는지 확인합니다.
4. 문제가 지속되면 이 저장소에 issue를 생성하여 도움을 요청하세요.

## 기여하기

기여는 언제나 환영합니다! 풀 리퀘스트를 자유롭게 제출해 주세요.

## 면책 조항

이 애드온의 사용에 따른 모든 책임은 사용자 본인에게 있습니다. 개발자 및 기여자는 이 애드온의 사용으로 인해 발생할 수 있는 어떠한 문제에 대해서도 책임을 지지 않습니다. 이 애드온을 사용함으로써 발생하는 모든 위험과 결과는 전적으로 사용자가 부담합니다.

이 애드온은 '있는 그대로' 제공되며, 어떠한 명시적이거나 묵시적인 보증도 하지 않습니다. 여기에는 특정 목적에 대한 적합성이나 상품성에 대한 보증이 포함되지만 이에 국한되지 않습니다.

사용자는 이 애드온을 사용하기 전에 모든 관련 문서를 주의 깊게 읽고 이해해야 하며, 애드온 사용으로 인한 모든 결과에 대해 전적인 책임을 집니다. 문제가 발생할 경우, 해결 책임은 전적으로 사용자에게 있습니다.

이 애드온을 사용하는 것은 위의 면책 조항을 완전히 이해하고 동의했음을 의미합니다.

## 알려진 문제

1. 설치 중 "The command '/bin/ash -o pipefail -c pip3 install --no-cache-dir paho-mqtt requests' returned a non-zero code: 1" 오류 발생:
   - 이 문제는 Python 패키지 설치 과정에서 발생할 수 있습니다.
   - 해결 방법: 애드온을 재빌드하고 재설치해보세요. 문제가 지속되면 최신 버전의 애드온을 사용하고 있는지 확인하세요.

문제가 지속되거나 다른 문제가 발생하면, 이슈를 생성하여 자세한 오류 메시지와 로그를 제공해 주세요.

## 버전 기록

### 0.1.3 (2024-07-26)
- Dockerfile 수정: 패키지 설치 방식 변경
- 애드온 빌드 및 설치 안정성 개선

### 0.1.2 (2024-07-23)
- Dockerfile 구조 개선 및 빌드 오류 수정
- 설치 문제 해결을 위한 문서 업데이트

### 0.1.1 (2024-07-22)
- 초기 버그 수정 및 안정성 개선

### 0.1.0 (2024-07-21)
- 초기 릴리스
- 전열교환기 On/Off 제어 기능 추가

## 버전 관리

이 애드온의 버전은 다음 파일들에서 관리됩니다:

1. `config.json`: 애드온의 공식 버전 번호를 정의합니다.
2. `README.md`: 버전 기록 섹션에서 각 버전의 변경 사항을 기록합니다.

버전을 업데이트할 때는 반드시 두 파일 모두 일관되게 수정해야 합니다. 버전 번호는 [시맨틱 버저닝](https://semver.org/) 규칙을 따릅니다.

예를 들어, 버전을 0.1.1에서 0.1.2로 업데이트하는 경우:

1. `config.json`의 "version" 필드를 "0.1.2"로 수정합니다.
2. `README.md`의 버전 기록 섹션에 새 버전에 대한 항목을 추가합니다.
3. 변경사항을 커밋하고 푸시합니다.
4. Home Assistant에서 애드온을 재빌드합니다.

이렇게 하면 버전 정보가 일관되게 유지되며, 사용자들이 최신 변경 사항을 쉽게 추적할 수 있습니다.